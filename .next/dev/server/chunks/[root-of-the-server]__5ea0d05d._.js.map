{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/hannahcho/Downloads/hackwestern/app/api/gemini/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { GoogleGenerativeAI } from \"@google/generative-ai\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { fullText, highlightedText, userQuestion } = await request.json()\n\n    // Validate that we have at least something to work with\n    if (!userQuestion && !highlightedText) {\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\n    }\n\n    // Get API key from environment\n    const apiKey = process.env.GEMINI_API_KEY\n\n    if (!apiKey) {\n      console.warn(\"[v0] GEMINI_API_KEY not configured\")\n      return NextResponse.json(\n        {\n          answer:\n            \"Gemini API key not configured. Please add GEMINI_API_KEY to your environment variables to enable AI responses.\",\n        },\n        { status: 200 },\n      )\n    }\n\n    let prompt: string\n\n    if (userQuestion && !highlightedText) {\n      // Learn tab case: just a question\n      prompt = `You are a helpful financial education assistant. Answer the following question clearly and concisely:\n\n${userQuestion}\n\nProvide a clear, educational response suitable for someone learning about finance.`\n    } else if (highlightedText && !userQuestion) {\n      // Highlight case: explain the highlighted text\n      prompt = `You are a helpful financial education assistant. A user is reading about finance and has highlighted some text.\n\n${fullText ? `Full context:\\n\"${fullText}\"\\n\\n` : \"\"}Highlighted text:\n\"${highlightedText}\"\n\nPlease explain the highlighted text in simple terms for someone learning about finance.`\n    } else {\n      // Both: highlighted text + question\n      prompt = `You are a helpful financial education assistant. A user is reading about finance and has highlighted some text.\n\n${fullText ? `Full context:\\n\"${fullText}\"\\n\\n` : \"\"}Highlighted text:\n\"${highlightedText}\"\n\nUser's question: ${userQuestion}\n\nProvide a clear, concise, and educational response.`\n    }\n\n    const genAI = new GoogleGenerativeAI(apiKey)\n    const model = genAI.getGenerativeModel({ model: \"gemini-2.0-flash-exp\" })\n\n    const result = await model.generateContent(prompt)\n    const response = await result.response\n    const answer = response.text()\n\n    return NextResponse.json({ answer })\n  } catch (error) {\n    console.error(\"[v0] Gemini API error:\", error)\n    return NextResponse.json(\n      {\n        error: \"Failed to process request\",\n        details: error instanceof Error ? error.message : \"Unknown error\",\n      },\n      { status: 500 },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,eAAe,EAAE,YAAY,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEtE,wDAAwD;QACxD,IAAI,CAAC,gBAAgB,CAAC,iBAAiB;YACrC,OAAO,4KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,+BAA+B;QAC/B,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;QAEzC,IAAI,CAAC,QAAQ;YACX,QAAQ,IAAI,CAAC;YACb,OAAO,4KAAY,CAAC,IAAI,CACtB;gBACE,QACE;YACJ,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI;QAEJ,IAAI,gBAAgB,CAAC,iBAAiB;YACpC,kCAAkC;YAClC,SAAS,CAAC;;AAEhB,EAAE,aAAa;;kFAEmE,CAAC;QAC/E,OAAO,IAAI,mBAAmB,CAAC,cAAc;YAC3C,+CAA+C;YAC/C,SAAS,CAAC;;AAEhB,EAAE,WAAW,CAAC,gBAAgB,EAAE,SAAS,KAAK,CAAC,GAAG,GAAG;CACpD,EAAE,gBAAgB;;uFAEoE,CAAC;QACpF,OAAO;YACL,oCAAoC;YACpC,SAAS,CAAC;;AAEhB,EAAE,WAAW,CAAC,gBAAgB,EAAE,SAAS,KAAK,CAAC,GAAG,GAAG;CACpD,EAAE,gBAAgB;;iBAEF,EAAE,aAAa;;mDAEmB,CAAC;QAChD;QAEA,MAAM,QAAQ,IAAI,kNAAkB,CAAC;QACrC,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAuB;QAEvE,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,MAAM,SAAS,SAAS,IAAI;QAE5B,OAAO,4KAAY,CAAC,IAAI,CAAC;YAAE;QAAO;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,4KAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}